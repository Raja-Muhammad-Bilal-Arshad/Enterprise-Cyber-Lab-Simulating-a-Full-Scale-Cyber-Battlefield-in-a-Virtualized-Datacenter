#  **6.2 : Secure Lab-Only Remote Admin Tool**

##  **Overview**

admin\_tool.py is a **TLS-encrypted**, **whitelisted-command** remote administration tool designed **strictly for lab and testing environments**.  
 It allows an operator (server) to send only safe, predefined commands to an agent (client) running on another host.

**Key Features**

* **TLS encryption** for all traffic

* **Strict command whitelist** (no arbitrary shell)

* **CSV logging** of all commands & responses

* **No port forwarding needed in local lab networks**

* **Interactive CLI with Rich library formatting**

âš  **DISCLAIMER:** This is for **controlled environments with explicit permission** only.  
 Do **not** run on production networks or untrusted systems.

---

## **ðŸ›  Installation & Requirements**

### **1\. Install Python & Dependencies**

Requires **Python 3.8+** and the rich library.

```bash

pip install rich

```

### **2\. Generate TLS Certificates**

Youâ€™ll need a certificate/key pair for the server and optionally for the agent.

Example (self-signed for testing):

```bash  
openssl req \-new \-x509 \-days 365 \-nodes \\  
  \-out server.crt \-keyout server.key \\  
  \-subj "/CN=LabServer"

openssl req \-new \-x509 \-days 365 \-nodes \\  
  \-out agent.crt \-keyout agent.key \\  
  \-subj "/CN=LabAgent"  
```
  
---

##  **Usage**

### **1\. Start the Server (Operator)**

```bash  
python3 admin\_tool.py \\  
  \--mode server \\  
  \--host 0.0.0.0 \\  
  \--port 4433 \\  
  \--cert server.crt \\  
  \--key server.key  
```

* Listens on the specified port for agent connections.

* Interactive console will show available commands.

---

### **2\. Start the Agent (Remote Host)**

```bash  
python3 admin\_tool.py \\  
  \--mode agent \\  
  \--server-ip \<SERVER\_IP\> \\  
  \--server-port 4433 \\  
  \--cert agent.crt \\  
  \--key agent.key \\  
  \--ca server.crt  
```

* Connects securely to the server.

* Accepts only whitelisted commands.

---

##  **Whitelisted Commands**

The agent can only execute:

* hostname â€“ show system hostname

* whoami â€“ show current user

* uptime â€“ show system uptime

* ls â€“ list files in a safe directory (no .. or absolute paths)

* date â€“ show system date & time

---

##  **Operator Console Commands**

Inside the serverâ€™s interactive prompt:

* list â€“ list connected agents

* send \<IP\> RUN \<command\> â€“ send whitelisted command to specific agent

Example:

```bash  
send 192.168.0.101 RUN hostname  
send 192.168.0.101 RUN ls /etc

```

* log â€“ shows where logs are stored

* exit â€“ shut down the server

---

##  **Logs**

All actions are saved in CSV files:

```yaml

* admin\_tool\_log\_server\_\<timestamp\>.csv

* admin\_tool\_log\_agent\_\<timestamp\>.csv

```

---

##  **Security Notes**

* No arbitrary command execution is possible (whitelist enforced).

* All traffic is TLS encrypted.

* Recommended to run **inside isolated lab networks only**.

* Use **mutual TLS** for extra authentication (\--ca option on both sides).

