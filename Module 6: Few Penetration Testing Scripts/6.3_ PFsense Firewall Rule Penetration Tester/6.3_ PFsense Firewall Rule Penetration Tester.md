# 6.3: **PFsense Firewall Rule Penetration Tester**

##   **Overview**

This Python script simulates **TCP**, **UDP**, and **ICMP** traffic to a specified target to help penetration testers and network administrators verify **PFsense firewall rules**.

It is intended for **lab and authorized environments only** to:

* Confirm if firewall rules allow or block specific packet types

* Test rule order and priority on PFsense or similar firewalls

* Generate traffic for monitoring and logging tests

 **DISCLAIMER:** Do not use on networks without explicit, written authorization.

---

##  **Requirements**

* **Python 3.8+**

**Scapy** for packet crafting and sending  
 Install via:  
```bash  
pip install scapy  
```  
Root privileges to send raw packets:  
```bash  
sudo python3 pfsense\_rule\_tester.py  
```

---

##  **How It Works**

* **TCP Packet Test:** Sends SYN packets to the target port

* **UDP Packet Test:** Sends UDP packets with a test payload

* **ICMP Flood Test:** Sends ICMP Echo Requests (ping)

* **Multi-threading:** Sends packets in parallel for speed

* **Configurable packet counts and threads** for stress or basic rule testing

---

##  **Usage**

**Run the script as root:**  
```bash  
sudo python3 pfsense\_rule\_tester.py

```

1. **Select test type:**  
   ```bash  
   \[1\] TCP Packet Test
   \[2\] UDP Packet Test
   \[3\] ICMP Flood Test
   \[0\] Exit
   ```

2. **Provide test parameters:**

   * **Target IP address**

   * **Target port** (if TCP/UDP)

   * **Number of threads** (parallel senders)

   * **Packets per thread**

---

##  **Example Run**

```bash

\==========================================  
   PFsense Rule Penetration Tester v3.0  
   Author: Friendly Red teamer  
   Purpose: Simulate TCP/UDP/ICMP tests  
\==========================================  
\[1\] TCP Packet Test  
\[2\] UDP Packet Test  
\[3\] ICMP Flood Test  
\[0\] Exit  
\==========================================  
\[?\] Select test type: 1  
\[?\] Enter Target IP Address: 192.168.1.10  
\[?\] Enter Target Port: 80  
\[?\] Enter Number of Threads: 5  
\[?\] Packets per Thread: 20

\==========================================  
\[+\] Test Completed in 2.14 seconds  
\[+\] Total Packets Sent: 100  
\==========================================
```

---

##  **Output**

The script displays:

* Total **execution time**

* **Number of packets sent**

* No captured responses â€” intended for **rule testing**, not service enumeration

---

##  **Security & Lab Guidelines**

* Only run in **authorized networks** or isolated test environments

* Avoid overloading production systems

* Useful for **validating firewall rules**, not bypassing them

