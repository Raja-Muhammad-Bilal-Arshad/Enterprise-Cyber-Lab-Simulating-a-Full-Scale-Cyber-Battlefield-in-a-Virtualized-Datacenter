# **6.4: DNS Query Logger & Spoof Simulation (Lab Use Only)**

##  **Overview**

This Python script logs DNS queries on a specified network interface and allows the user to **simulate** DNS spoofing in a **controlled test environment**.  
 It’s designed for **penetration testing labs** to demonstrate:

* How DNS queries can be captured

* How spoofed DNS replies could redirect traffic

⚠ **DISCLAIMER:** This tool is for **educational purposes in authorized lab environments only**.  
 Do **not** use on networks without explicit written permission.

---

##  **Requirements**

* **Python 3.8+**

* **Scapy** (for packet sniffing and crafting)

* Root privileges (to capture and send raw packets)

* A network interface in **monitor or promiscuous mode** (if needed)

### **Install Scapy**

\`\`\`bash  
pip install scapy

\`\`\`

---

##  **Configuration**

Inside the script, set your network interface:

\`\`\`python  
CAPTURE\_INTERFACE \= "wlan0"  
\`\`\`

Change "wlan0" to your interface (e.g., eth0, ens33).

When you run the script, it will ask for:

* **Target client IP** (device to simulate spoofing against)

* **Domain to spoof** (e.g., example.com)

* **IP address to spoof to** (fake IP returned in spoof simulation)

---

##  **Usage**

1. **Run as root**:  
   \`\`\`bash

sudo python3 dns\_logger\_simulation.py  
\`\`\`

2. **Provide input when prompted**:

\`\`\`bash  
Enter target client IP: 192.168.1.50  
Enter domain to spoof: example.com  
Enter IP address to spoof to: 192.168.1.100  
\`\`\`

3. The script will:

   * Start logging DNS queries to dns\_log.txt

   * Every 5 minutes, show the last set of unique queries

   * Ask if you want to **simulate spoofing** for the configured domain

4. **Simulation example**:  
   \`\`\`bash

\[SIMULATION\] Sent fake DNS reply: example.com → 192.168.1.100 to 192.168.1.50

\`\`\`

---

##  **Log Format**

dns\_log.txt entries look like:

\`\`\`bash  
Sat Aug  9 12:35:42 2025 \- 192.168.1.50 → example.com.  
Sat Aug  9 12:35:44 2025 \- 192.168.1.51 → google.com.  
\`\`\`  
---

##  **Security & Lab Notes**

* The **spoofing** here is a **simulation**, not a persistent MITM attack.

* Use an isolated lab network or VM environment.

* Requires **explicit permission** before use.

* The script **does not** attempt to interfere with legitimate DNS servers in production.

